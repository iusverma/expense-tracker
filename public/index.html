<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Expense Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }

    form {
      display: grid;
      grid-template-columns: 120px 1fr 120px 1fr;
      gap: 10px 15px;
      max-width: 700px;
      margin-bottom: 20px;
    }

    label {
      text-align: right;
      padding-top: 5px;
    }

    input,
    select,
    button {
      padding: 6px;
      font-size: 14px;
    }

    button {
      justify-self: end;
      /* align button to the right */
    }

    #expensesTable {
      border-collapse: collapse;
      width: 100%;
      margin-top: 10px;
    }

    #expensesTable th,
    #expensesTable td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: left;
    }

    #expensesTable th {
      background: #f4f4f4;
    }
  </style>

</head>

<body>
  <div style="position: fixed; top: 20px; right: 20px;">
    <a href="reports.html">ðŸ“Š Reports</a>
  </div>

  <h2>Expense Tracker</h2>
  <form id="expenseForm">
    <!-- Row 1: Date -->
    <label for="date">Date:</label>
    <input type="date" id="date" required style="grid-column: span 3;">

    <!-- Row 2: Note + Amount -->
    <label for="note">Details:</label>
    <input type="text" id="note" placeholder="Optional note">
    <label for="amount">Amount:</label>
    <input type="number" id="amount" placeholder="Enter amount" required>

    <!-- Row 3: Paid By + Category -->
    <label for="paid_by">Paid By:</label>
    <select id="paid_by" required></select>
    <label for="category">Category:</label>
    <select id="category" required></select>

    <!-- Row 4: Recurring + ThreeFs -->
    <label for="recurring">Recurring:</label>
    <select id="recurring" required>
      <option value="No">No</option>
      <option value="Yes">Yes</option>
    </select>
    <label for="threefs">ThreeFs:</label>
    <select id="threefs" required>
      <option value="Fixed">Fixed</option>
      <option value="Fun">Fun</option>
      <option value="Future">Future</option>
    </select>

    <!-- Row 5: Custom -->
    <label for="custom">Custom Details:</label>
    <input type="text" id="custom" placeholder="Enter details" style="grid-column: span 3;">

    <!-- Row 6: Button -->
    <div></div>
    <div></div>
    <div></div>
    <button type="submit">Add Expense</button>
  </form>

  <script>
    document.getElementById("expenseForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const expense = {
        date: document.getElementById("date").value,
        amount: parseFloat(document.getElementById("amount").value),
        category: document.getElementById("category").value,
        note: document.getElementById("note").value,
        paid_by: document.getElementById("paid_by").value
      };
      await fetch("/api/expenses", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(expense)
      });
      loadExpenses();
      e.target.reset();
    });

    async function loadCategories() {
      const res = await fetch("/api/categories");
      const categories = await res.json();
      const select = document.getElementById("category"); //put inside config
      select.innerHTML = ""; // clear existing options
      categories.forEach(cat => {
        const option = document.createElement("option");
        option.value = cat;
        option.textContent = cat;
        select.appendChild(option);
      });
    }

    async function loadPaidBy() {
      const res = await fetch("/api/paidby");
      const paidBys = await res.json();
      const select = document.getElementById("paid_by");
      select.innerHTML = "";
      paidBys.forEach(pb => {
        const option = document.createElement("option");
        option.value = pb;
        option.textContent = pb;
        select.appendChild(option);
      });
    }

    loadPaidBy();
    loadCategories();

  </script>

</body>

</html>